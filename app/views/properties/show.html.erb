<p id="notice"><%= notice %></p>


<div class = 'wrapper--horizontal'>
  <div class = 'wrapper--vertical'>
    <div class = 'properties__block properties__block--large'>
      <img src = "<%= "/assets/house#{@property.id - 1}.jpg" %>" class = 'image image--large'>
    </div>

    <div class = 'property__address'>
      <%= @property.address %>
    </div>
  </div>

  <div class = 'wrapper--vertical'>
    <p>Time remaining:</p>
    <div class = 'bright-text'>
      <div id="countdown"></div>
    </div>

    <p>Current Offer:</p>
    <div class = 'bright-text'>
      $100,000
    </div>

    <%= link_to "/properties/#{@property.id}/new_bid" do %>

      <button class = 'btn btn--offer'>
        Make an Offer
      </button>
    <% end %>
  </div>
</div>


<br><br>


<!-- Only show bid history once there are bids -->
<% if @property.bids.present? %>
  <h2> Offer History: </h2>

  <table>
    <thead>
      <tr>
        <th>Amount</th>
        <th>Submit time</th>
        <th>Deposit %</th>
        <th>Terms</th>

      </tr>
    </thead>

    <tbody>
      <% @property.bids.each do |bid| %>
        <tr>
          <td>$<%= number_with_delimiter(bid.amount) %></td>
          <td><%= bid.submit_time.strftime("%A %e %B %l:%M%P ")  %></td>
          <td><%= bid.deposit_percent %>%</td>
          <td><%= bid.terms %></td>

        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<div class = 'wrapper--horizontal min-price'>
  <span>
    $<%= number_with_delimiter(@property.price) %>:
    minimum price the seller will accept
  </span>
</div>


<!-- Display the countdown timer in an element -->


<script>
// Set the date we're counting down to
var countDownDate = new Date("Jan 5, 2018 15:37:25").getTime();

// Update the count down every 1 second
var x = setInterval(function() {

  // Get todays date and time
  var now = new Date().getTime();

  // Find the distance between now an the count down date
  var distance = countDownDate - now;

  // Time calculations for days, hours, minutes and seconds
  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  var seconds = Math.floor((distance % (1000 * 60)) / 1000);

  // Display the result in the element with id="demo"
  document.getElementById("countdown").innerHTML = hours + "h "
  + minutes + "m " + seconds + "s ";

  // If the count down is finished, write some text
  if (distance < 0) {
    clearInterval(x);
    document.getElementById("countdown").innerHTML = "Final Offer Accepted!";
  }
}, 1000);
</script>
